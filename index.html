<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Encrypted Transmission</title>

<style>
html, body {
  margin: 0;
  padding: 0;
  background: #1e1e1e;
  font-family: "Courier New", monospace;
  height: 100%;
  overflow: hidden;
}

#editor {
  padding: 60px;
  font-size: 18px;
  line-height: 1.8;
  color: #d4d4d4;
  white-space: pre;
}

/* Cursor */
.cursor {
  display: inline-block;
  width: 8px;
  background: #d4d4d4;
  animation: blink 1s infinite;
}
@keyframes blink {
  0%,50%,100% { opacity: 1; }
  25%,75% { opacity: 0; }
}

/* VS Code Dark+ */
.token-keyword   { color: #569CD6; }
.token-string    { color: #CE9178; }
.token-function  { color: #DCDCAA; }
.token-number    { color: #B5CEA8; }
.token-operator  { color: #d4d4d4; }
.token-brace     { color: #FFD700; }
.token-dot       { color: #9CDCFE; }
.token-semicolon { color: #d4d4d4; }
.token-property  { color: #9CDCFE; }

/* Suggestions */
#suggestions {
  position: absolute;
  background: #252526;
  border: 1px solid #3c3c3c;
  padding: 6px 0;
  font-size: 14px;
  color: #d4d4d4;
  width: 240px;
  display: none;
  box-shadow: 0 8px 20px rgba(0,0,0,0.6);
  border-radius: 4px;
}
.suggestion-item {
  padding: 6px 12px;
}
.suggestion-item:hover {
  background: #094771;
}
</style>
</head>

<body>

<div id="editor"></div>

<div id="suggestions">
  <div class="suggestion-item">inject("The Invisible Man")</div>
  <div class="suggestion-item">signal("The Last Vision")</div>
  <div class="suggestion-item">connect("561.305.9696")</div>
  <div class="suggestion-item">mail("thelastvision@live.com")</div>
</div>

<script>

const editor = document.getElementById("editor");
const suggestions = document.getElementById("suggestions");

let lines = [];
let cursorLine = 0;
let cursorPos = 0;

function render() {
  editor.innerHTML = "";

  lines.forEach((line, index) => {
    const div = document.createElement("div");

    if (index === cursorLine) {
      const before = line.slice(0, cursorPos);
      const after = line.slice(cursorPos);
      div.innerHTML = before + `<span class="cursor"></span>` + after;
    } else {
      div.innerHTML = line;
    }

    editor.appendChild(div);
  });
}

function typeText(text, speed = 20, callback) {
  let i = 0;
  const interval = setInterval(() => {
    lines[cursorLine] =
      lines[cursorLine].slice(0, cursorPos) +
      text[i] +
      lines[cursorLine].slice(cursorPos);

    cursorPos++;
    i++;
    render();

    if (text[i - 1] === ".") {
      const rect = editor.children[cursorLine].getBoundingClientRect();
      suggestions.style.left = rect.left + 300 + "px";
      suggestions.style.top = rect.top + "px";
      suggestions.style.display = "block";
      setTimeout(() => suggestions.style.display = "none", 1000);
    }

    if (i >= text.length) {
      clearInterval(interval);
      if (callback) setTimeout(callback, 200);
    }
  }, speed);
}

function newLine(indent = "") {
  lines.splice(cursorLine + 1, 0, indent);
  cursorLine++;
  cursorPos = indent.length;
  render();
}

function insertBlock(indent = "") {
  // Insert opening brace
  typeText(`<span class="token-brace">{</span>`, 5, () => {

    // Create new indented line
    newLine(indent + "    ");

    // Insert closing brace on next line
    lines.splice(cursorLine + 1, 0, indent + `<span class="token-brace">}</span>`);
    render();
  });
}

/* ===== Animation Script ===== */

function start() {

  lines.push("");
  render();

  typeText(`<span class="token-keyword">class</span> <span class="token-function">Transmission</span> `, 20, () => {
    insertBlock("");

    setTimeout(() => {

      typeText(`<span class="token-keyword">void</span> <span class="token-function">main</span>() `, 20, () => {
        insertBlock("    ");

        setTimeout(() => {

          typeText(`<span class="token-keyword">if</span> (visibility == false) `, 20, () => {
            insertBlock("        ");

            setTimeout(() => {

              typeText(`<span class="token-property">identity</span><span class="token-dot">.</span><span class="token-function">inject</span>("The Invisible Man");`, 15, () => {

                newLine("            ");

                typeText(`<span class="token-property">network</span><span class="token-dot">.</span><span class="token-function">signal</span>("The Last Vision");`, 15, () => {

                  newLine("            ");

                  typeText(`<span class="token-property">contact</span><span class="token-dot">.</span><span class="token-function">connect</span>("561.305.9696");`, 15, () => {

                    newLine("            ");

                    typeText(`<span class="token-property">contact</span><span class="token-dot">.</span><span class="token-function">mail</span>("thelastvision@live.com");`, 15);

                  });

                });

              });

            }, 400);

          });

        }, 400);

      });

    }, 400);

  });

}

start();

</script>

</body>
</html>
